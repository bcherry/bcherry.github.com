<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Adequately Good - Posts from 2009</title>

    <!-- CSS, including Blueprint, jQuery w/Smoothness, and AG CSS -->
    <link rel="stylesheet" href="/css/blueprint/blueprint.min.css" media="screen, projection" />
    <link rel="stylesheet" href="/css/blueprint/print.min.css" media="print" />
    <!--[if lt IE 8]>
      <link rel="stylesheet" href="/css/blueprint/ie.css" media="screen, projection">
    <![endif]-->
    <link rel="stylesheet" href="/css/jquery-ui-smoothness/jquery-ui-1.7.2.custom.min.css" />
    <link rel="stylesheet" href="/css/ag.css" media="screen" />

    <!-- Extra <head> Links -->
    <link rel="alternate" type="application/atom+xml" title="Adequately Good Atom Feed" href="" />

    <!-- TODO: favicon -->

    <!-- IE HTML5 Compatibility -->
    <!--[if IE]>
      <script type="text/javascript">
        (function () {
          var tags = "header hgroup nav article time footer".split(" "),
            i = 0,
            l = tags.length;
          for (; i < l; i += 1) {
            document.createElement(tags[i]);
          }
        }());
      </script>
    <![endif]-->
  </head>
  <body>
    <a name="top"></a>
    <div id="container" class="container">

      <!-- Header -->
      <header class="span-24 last">
        <!-- Title -->
        <div id="title" class="span-24 last">
          <div class="span-17 colborder prepend-top append-bottom">
            <hgroup>
              <h1>
                <a href="/">adequately good</a>
              </h1>
              <h3 class="prepend-2 alt">decent programming advice</h3>
            </hgroup>
          </div>
          <div class="span-6 last prepend-top append-bottom">
            <h2>
              written by
              <a href="http://twitter.com/bcherry">ben cherry</a>
            </h2>
          </div>
        </div>

        <hr />

        <!-- Navigation Bar -->
        <nav class="prepend-2 span-20 append-2 last append-bottom">
          <div class="span-5">
            <a href="/">home</a>
          </div>
          <div class="span-5">
            <a href="#" id="archiveLink">archives</a>
          </div>
          <div class="span-5">
            <a href="/About-Ben">about</a>
          </div>
          <div class="span-5 last">
            <a href="">feed</a>
          </div>
        </nav>

        <!-- Archives Links -->
        <div id="archives" class="span-24 last smallalts" style="display:none;">
          <hr />
          <div class="archivelinks">
            <span class="alt">posts by year</span>
            
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
                  <a class="tight" href="/2009">2009</a>
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
                  <a class="tight" href="/2010">2010</a>
                
              
            
              
                
                
                
              
            
              
                
                
                
                  <a class="tight" href="/2011">2011</a>
                
              
            
          </div>
        </div>

        <hr />
      </header>

      <div id="colcontainer" class="span-24 last">
        <!-- Main content: Posts, etc. -->
        <div id="content" class="span-17 colborder">
          <a name="main"></a>
          <div class="smallalts listing">
  <span class="alt">all posts from the year</span>
  <a class="tight" href="/2009">2009</a>
</div>


  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  
    <article class="span-17 last">
  <header class="span-17 last">
  
    <time class="alt" datetime="2009-11-28" pubdate>2009-11-28</time>
  
  <h1><a href="/2009/11/Consuljs-Simple-Logging-Abstraction">Consul.js, Simple Logging Abstraction</a></h1>
</header>
  <div class="span-17 last entry">
    <p>I've been reading <em>Coders At Work</em> by Peter Seibel, and one question he asks in every interview is "How do you debug - print statements, debugger like gdb, or something else?".  For me, print statements are my first tool for any situation.  That's why Firebug is so crucial to my work on the web, because writing and debugging advanced JavaScript would be a nightmare without it.  While working on code, my files are littered with <code class="js inline">console.log()</code> statements and the like.  Unfortunately, shipping code with these statements is a no-no, so I usually pull them out.  Frustrated with this process, I decided to build an alternative and throw some new features in along the way.</p>

<p><pre class="js">consul.log("This is a log message");
consul.warn("I even support fancier %s features like %o.", "Firebug", "format strings");
consul.turnOff();
consul.assert(false, "I'm off, so you won't see this error fire.");
consul.turnOn();
consul.info("See this message in Firebug, Chrome, Safari, Firebug Lite, IE8, and Opera.")</pre></p>

<p>Meet <a href="http://github.com/bcherry/bcherry/blob/master/bcherry-web/static/lib/js/consul.js">consul.js</a>, which acts as a wrapper for the standard <code class="js inline">window.console</code> features from <a href="http://getfirebug.com/wiki/index.php/Console_API">Firebug</a>.  Using it is simple, as you see above.  Just include the file, and start using <code class="js inline">consul</code> instead of <code class="js inline">console</code>.  You can easily turn it off for your live code, but have easy access to the messages by simply turning it back on from the command line.</p>

<p>In addition to what you'd expect, using consul.js ensures that you can view your messages and assertions in any browser.  Currently, it supports the latest versions of Firebug, Chrome, and Safari (you'll need the JS console for the latter two).  I also built in support for most commands in Internet Explorer 8, provided you've got the developer tools open.  Opera Dragonfly support was harder, since it doesn't offer much logging features.  However, most things work through <code class="js inline">window.opera.postError()</code>.  Regardless, for IE and Opera (as well as any other browser), it checks for Firebug Lite and outputs there if it finds it, instead of the built-in dev tools.</p>

<p>For a list of features and browser support, look no further than the code itself:</p>

<p><pre class="js">var consoleFuncs = {
	log         : b("firebug", "firebuglite", "chromium", "safari", "ie", "opera"),
	debug       : b("firebug", "firebuglite", "chromium", "safari"),
	info        : b("firebug", "firebuglite", "chromium", "safari", "ie", "opera"),
	warn        : b("firebug", "firebuglite", "chromium", "safari", "ie", "opera"),
	error       : b("firebug", "firebuglite", "chromium", "safari", "ie", "opera"),
	assert      : b("firebug", "firebuglite", "chromium", "safari", "ie", "opera"),
	dir         : b("firebug", "firebuglite", "chromium", "safari"),
	dirxml      : b("firebug", "firebuglite", "chromium", "safari"),
	trace       : b("firebug", "firebuglite", "chromium", "safari"),
	group       : b("firebug", "firebuglite", "chromium", "safari"),
	groupEnd    : b("firebug", "firebuglite", "chromium", "safari"),
	time        : b("firebug", "firebuglite", "chromium", "safari"),
	timeEnd     : b("firebug", "firebuglite", "chromium", "safari"),
	count       : b("firebug", "firebuglite", "chromium", "safari")
};</pre></p>

<p>If a function is not supported in a particular browser, it will simply be ignored, rather than throwing an error.</p>

<p>So <a href="http://github.com/bcherry/bcherry/blob/master/bcherry-web/static/lib/js/consul.js">give it a shot</a>, and let me know what you think!  This tool helped me build this blog's front-end code, and has already been ported into the code I use at work, so I can take advantage of the same tool.  I think it's a big win for JavaScript developers who rely on the Firebug console, and introduces a lot of new flexibility without degrading simplicity.</p>
  </div>
</article>

  

  
  
    <article class="span-17 last">
  <header class="span-17 last">
  
    <time class="alt" datetime="2009-11-05" pubdate>2009-11-05</time>
  
  <h1><a href="/2009/11/Javascript-Pseudo-threading">Javascript Pseudo-threading</a></h1>
</header>
  <div class="span-17 last entry">
    <p><strong><em>This post has been migrated from my old, defunct blog at bcherry.net. The links may not work, and the formatting may be wonky.</em></strong></p>

<p>I&#8217;ve been playing around with asynchronous Javascript for repeated large-set actions, in the hopes of generating some useful techniques for real applications. I&#8217;ve narrowed down a successful technique that I call &#8220;simplethreading&#8221;. Check out a demo <a href='http://bcherry.net/simplethreading_old'>here</a> or the resulting source code <a href='http://github.com/bcherry/simplethreading'>here</a>. The demo lets you play with the size of the data set, and also the operation queue size. I found that queuing operations in batches was quite a bit faster than queuing them individually, so that each fired event will process a few data objects instead of just 1. I&#8217;d guess the reason for this is that Javascript only supports timeouts at the millisecond level, when most operations are shorter than that. By grouping operations into larger chunks, we can make much better use of the time we&#8217;re given.</p>

<p>Here&#8217;s the code for both the blocking (I call it &#8220;singlethreaded&#8221;) and non-blocking (I call it &#8220;simplethreaded&#8221; because it&#8217;s not really multi-threaded, but it&#8217;s not really single-threaded either) version. Note that <code>{@class=js inline}ST.s</code> and <code>{@class=js inline}ST.n</code> refer to the querystring parameters &#8216;s&#8217; and &#8216;n&#8217;.:</p>

<pre><code>ST.functions = [
	function (n, context) {
		$(context).append($(&quot;&lt;div&gt;&quot;).addClass(&quot;result&quot;).attr(&quot;id&quot;,&quot;r&quot;+n).text(n));
	}, function (n, context) {
		$(&quot;#r&quot; + n + &quot;.result&quot;, context).addClass(&quot;dark&quot;);
	}, function (n, context){
		$(&quot;#r&quot; + n + &quot;.result&quot;, context).remove();
	}
];

/** singlethreaded approach **/
ST.singleStage = 0;
ST.SingleGenerator = function(n) {
	var i = 0;
	this.next = function() {
		if (i &amp;gt; n || i &amp;gt; ST.singlelimit) {
			return null;
		}
		return i++;
	};
};
ST.startsingle = function() {
	var context = $(&quot;#singlethreaded .output&quot;);
	var gen = new ST.SingleGenerator(ST.n);
	var n;
	var workFn = ST.functions[ST.singleStage];
	ST.singleStage++;
	ST.singleStage = ST.singleStage % ST.functions.length;
	while ((n = gen.next()) !== null) {
		workFn(n,context);
	}
};

/** simplethreaded approach **/
ST.simpleStage = 0;
ST.SimpleGenerator = function(n) {
	var i = 0;
	this.next = function() {
		if (i &amp;gt; n) {
			return null;
		}
		return i++;
	};
};
ST.startsimple = function() {
	var context = $(&quot;#simplethreaded .output&quot;);
	var gen = new ST.SimpleGenerator(ST.n);
	var n;
	var workFn = ST.functions[ST.simpleStage];
	ST.simpleStage++;
	ST.simpleStage = ST.simpleStage % ST.functions.length;
	var fn = function() {
		var i = 0;
		while (i++ &amp;lt; ST.s &amp;amp;&amp;amp; (n = gen.next()) !== null) {
			workFn(n,context);
		}
		if (n === null) {
			clearInterval(threadID);
		}
	};
	var threadID = setInterval(fn,1);
};</code></pre>

<p>The resulting code is actually pretty straightforward. The key is to maintain the ID returned by the <code>{@class=js inline}setInterval()</code> call so it can be killed when you&#8217;re done with your work. Normally this would get stuffed into a global, but by wrapping the whole lot into a function and then sending a local function reference into <code>{@class=js inline}setInterval()</code>, I can take advantage of Javascript&#8217;s closure to keep the locals I need around for every asynchronous function call, which is really awesome.</p>

<p>Also, using a generator is a pretty neat way to produce the data I need, and lets me work with arbitrary data pretty easily. In a real application where the data is coming from the server asynchronously, I can have the generator returning data from a queue as it comes in, while returning flags like &#8220;all done&#8221; so the thread knows it won&#8217;t see more data or &#8220;wait for it&#8221; so the thread can stick around and poll for new data when it comes in.</p>

<p>I think that if I were to bring this into a real application, I would have it decide between singlethreaded or simplethreaded dynamically, because it&#8217;s obvious that singlethreaded is much better for smaller sets.</p>
  </div>
</article>

  

  
  
    <article class="span-17 last">
  <header class="span-17 last">
  
    <time class="alt" datetime="2009-11-05" pubdate>2009-11-05</time>
  
  <h1><a href="/2009/11/Building-a-Better-Friend-Selector">Building a Better Friend Selector</a></h1>
</header>
  <div class="span-17 last entry">
    <p><strong><em>This post has been migrated from my old, defunct blog at bcherry.net. The links may not work, and the formatting may be wonky.</em></strong></p>

<p>Working in social entertainment, one of the lynchpins of the entire business is the friend selector. Without it, there is virtually no way to grow your customer base. Having a simple, effective friend selector is absolutely critical. On Facebook, they provide you with either the <a href='http://wiki.developers.facebook.com/index.php/Fb:multi-friend-selector' target='_blank'>multi-friend-selector</a> or the <a href='http://wiki.developers.facebook.com/index.php/Fb:multi-friend-selector_%28condensed%29' target='_blank'>condensed multi-friend-selector</a>. If you&#8217;ve ever played a Facebook game like <a href='http://apps.new.facebook.com/inthemafia/' target='_blank'>Mafia Wars</a> or <a href='http://apps.facebook.com/onthefarm' target='_blank'>Farmville</a> or <a href='http://apps.facebook.com/slidepets/' target='_blank'>SuperPoke! Pets</a>, then you&#8217;re probably already familiar with both of these controls. However, the situation is much more sparse on other networks. And if you&#8217;re talking about implementing a network independent game, like <a href='http://www.superpokepets.com' target='_blank'>SuperPokePets.com</a>, then you&#8217;ll eventually need to write your own.</p>

<p>I&#8217;ve begun a project in my free time to make a truly great friend selector control, for use in our own applications and elsewhere. You can find the result <a href='http://bcherry.net/babfs' target='_blank'>here</a>, and the source code is available on <a href='http://github.com/bcherry/babfs/tree/master' target='_blank'>GitHub</a>. I&#8217;m constantly working on improving it. What I&#8217;ve built is not useful just for friends lists, but could feasibly serve as a good control for any sort of list selection. It began as a simple exercise in <a href='http://bcherry.net/archives/89' target='_blank'>good Javascript</a>, seeing how quickly I could replicate every feature of the Facebook condensed multi-friend-selector (the answer was about 2 hours). But as I worked on it more, I realized that I was capable of producing something of real value to our business. I hope to tackle advanced problems like performance with our so-called &#8220;whale users&#8221;, who have tens of thousands of friends. My initial attempt starts to break down over 1000 friends, and crashes the browser as I reach above 10000.</p>

<p>You can use it by including the Javascript and CSS files (found in <a href='http://github.com/bcherry/babfs/tree/master' target='_blank'>Git</a>), then making a simple call to the constructor. The data is expected to be a list of objects, each of which has the properties &#8216;name&#8217;, &#8216;id&#8217;, and &#8216;tabs&#8217; (optional). If you don&#8217;t want the tabs, just don&#8217;t pass a &#8216;tabs&#8217; list, and don&#8217;t include it on your dataset. In the future, the object returned from the constructor will have some useful public methods.</p>

<pre><code>var bfs = new BetterFriendSelector({
  action:&quot;index.html&quot;,
  method:&quot;GET&quot;,
  submit_text:&quot;Send Friend Request&quot;,
  data:fs_data,
  limit:10,
  elem:$(&quot;#bfs&quot;),
  tabs:[{key:&quot;hasapp&quot;,name:&quot;Friends With App&quot;},          {key:&quot;nonapp&quot;,name:&quot;Friends Without App&quot;}],
  extra_form_params:extra_form_params
});</code></pre>

<p>Anyways, I&#8217;d like to go through the implementation of what I have so far.</p>
<h3>Disappearing Checkboxes</h3><p>This is the best feature of the condensed selector on Facebook.  When a user clicks to select one of their friends, the entry moves to the "selected" area, but with an 'X' instead of a checkbox.  This makes it easy to see who's been selected, even while filtering or tabbing the results.  Here's how I did that:</p>
<pre><code>// Friend selected event
selector.find(&quot;input[type=checkbox]&quot;).change(function(){
  var count = selector.find(&quot;input[type=checkbox][checked=true]     length;
  if (count &gt; limit) {
    $(this).attr(&quot;checked&quot;,false);
    return false;
  }
  $(this).parents(&quot;.friend&quot;).addClass(&quot;hidden&quot;);
  var selected_elem = $(&quot;&lt;div id=&quot;&quot;&gt;&quot;).addClass(&quot;selected_frien    ;
  selected_elem.tmpl(BFS.templates.selected_elem,{&quot;name&quot;:$(this    siblings(&quot;label&quot;).text(), &quot;id&quot;:$(this).attr(&quot;id&quot;)});
  selector.find(&quot;.selected&quot;).append(selected_elem);
});
// Friend unselected event
selector.find(&quot;.remove&quot;).live(&quot;click&quot;,function(){
  selector.find(&quot;.unselected #&quot; + $(this).attr(&quot;id&quot;)).att    &quot;checked&quot;,false).parents(&quot;.friend&quot;).removeClass(&quot;hidden&quot;);
  $(this).parents(&quot;.selected_friend&quot;).remove();
});</code></pre>
<p>I think this is fairly straightforward, so I'll just list a few points to help understand it:</p><ol>
<li>The correct event to bind is "change".  My first attempt had me binding to the "click" event on the checkbox, which was flawed.  You can modify the checkbox by clicking it, with your keyboard, or clicking on the label, not to mention other Javascript.  "change" catches all of these options</li>
<li>I use the friend's id to index the items.  Checkboxes have an id of 'cbXXX' and the corresponding 'selected' element has an id of 's_cbXXX'.</li>
<li>I'm using John Resig's <a href='http://bcherry.net/archives/97' target='_blank'>micro-templates</a>, so that's what the <code class='js inline'>.tmpl()</code> call is.  The template data is stored in a static collection of strings.</li>
<li>I allow the developer to specify a selection limit ("select up to X friends"), and enforce that in the 'change' event.  Returning false prevents the checkbox from becoming selected.</li>
<li>My first attempt used <code class='js inline'>.hide()</code> and <code class='js inline'>.show()</code>, which seems to be natural.  I changed it to a class with 'display:none;'.  This is because there are a number of reasons a friend element might be hidden, such as being filtered or toggled.  Using classes for these ensures they stay hidden when I want them to be.</li>
</ol><h3>Typeahead Name Filter</h3><p>There are plenty of solutions for typeahead to be found online, but I decided to implement my own.  It turned out to be really easy, so I'll just show the code and a few points.  The key feature of my implementation is that it filters on the start of the first and last name simultaneously, so entering 'be' will keep both 'Ben Franklin' and 'David Beckham'.</p>
<pre><code>var filter = selector.find(&quot;.filter input&quot;);
var reset_filter = function(){
filter.addClass(&quot;empty&quot;).val(filter.siblings(&quot;.__empty_text&quot;).tex    ));
};
// Filter changed event
var do_filter = function() {
var filter_text = filter.val();
if (filter_text == filter.siblings(&quot;.__empty_text&quot;).text()) {
filter_text = &quot;&quot;;
}
selector.find(&quot;.unselected label&quot;).each(function(){
with($(this)) {
if(!text().match(&quot;^&quot; + filter_text) &amp;&amp; !text().match(&quot;[- \t]+&quot;     filter_text)) {
parents(&quot;.friend&quot;).addClass(&quot;filtered&quot;);
} else {
parents(&quot;.friend&quot;).removeClass(&quot;filtered&quot;);
}
}
});
};
filter.keyup(do_filter);
// Filter preloaded text stuff
reset_filter();
filter.focus(function() {
if ($(this).val() == $(this).siblings(&quot;.__empty_text&quot;).text()) {
$(this).removeClass(&quot;empty&quot;).val(&#39;&#39;);
}
});
filter.blur(function() {
if ($(this).val() == &quot;&quot;) {
reset_filter();
}
});
selector.find(&quot;.filter .clear_filter&quot;).click(function(){
reset_filter();
do_filter();
});</code></pre>
<ol>
<li>I'm using a class instead of <code class='js inline'>.hide()</code> and <code class='js inline'>.show()</code> for the same reason as above</li>

<li>The textbox is watermarked using the text in a hidden element next to the textbox</li>
</ol><h3>What's Next?</h3><p>I hope someone finds this control or it's code to be useful.  I'm going to keep working on it, and I hope to create something that becomes useful at Slide.  My next task is to create a mechanism for handling our "whale users", probably some sort of smart pagination.  I'll also be adding some public methods like <code class='js inline'>selectRandom()</code> to make the control easily programmable.  Another hurdle will be allowing friend data to be loaded dynamically, by passing some sort of generator function to my control.  Again, I hope this was useful, and let me know if you're using or modifying this!</p>
  </div>
</article>

  

  
  


        </div>

        <!-- Sidebar: Search, links, etc. -->
        <div id="sidebar" class="span-6 last">
          <hr class="space" />

          <div id="links">
            <h3>the author</h3>
            <p>
              Ben is a 25 year-old software engineer. He lives and works in San Francisco. Many people think he invented the term "hoisting" in JavaScript, but this is untrue.
            </p>
            <ul>
              <li><a href="http://twitter.com/bcherry">Twitter</a> - @<a class="twitter-anywhere-user" href="http://twitter.com/bcherry">bcherry</a></li>
              <li><a href="http://github.com/bcherry">GitHub</a> - My Code</li>
              <li><a href="http://www.linkedin.com/in/bcherryprogrammer">LinkedIn</a> - Professional Profile</li>
              <li><a href="http://www.facebook.com/bcherry">Facebook</a> - That Other Social Network</li>
              <li><a href="http://www.bcherry.net/talks/">Presentations</a> - Slides From My Talks</li>
            </ul>
            <iframe allowtransparency="true" frameborder="0" scrolling="no"
              src="http://platform.twitter.com/widgets/follow_button.html?screen_name=bcherry&amp;button=grey&amp;text_color=7F7F7F&amp;link_color=666666"
              style="width:300px; height:20px;"></iframe>
          </div>

          <hr />

          <div id="tags">
            <h3>categories</h3>
            <ul>
            
              <li>
                <a href="/tag/javascript">javascript</a>
                (18)
              </li>
            
              <li>
                <a href="/tag/social%20gaming">social gaming</a>
                (1)
              </li>
            
              <li>
                <a href="/tag/performance">performance</a>
                (4)
              </li>
            
              <li>
                <a href="/tag/jquery">jquery</a>
                (1)
              </li>
            
              <li>
                <a href="/tag/tools">tools</a>
                (2)
              </li>
            
              <li>
                <a href="/tag/html5">html5</a>
                (3)
              </li>
            
              <li>
                <a href="/tag/adequatelygood">adequatelygood</a>
                (1)
              </li>
            
              <li>
                <a href="/tag/timers">timers</a>
                (2)
              </li>
            
              <li>
                <a href="/tag/module%20pattern">module pattern</a>
                (3)
              </li>
            
              <li>
                <a href="/tag/talks">talks</a>
                (1)
              </li>
            
              <li>
                <a href="/tag/slide">slide</a>
                (1)
              </li>
            
              <li>
                <a href="/tag/python">python</a>
                (1)
              </li>
            
              <li>
                <a href="/tag/debugging">debugging</a>
                (1)
              </li>
            
              <li>
                <a href="/tag/testing">testing</a>
                (2)
              </li>
            
              <li>
                <a href="/tag/hashbang">hashbang</a>
                (1)
              </li>
            
            </ul>
          </div>

          <hr />

          
        </div>
      </div>
    </div>

    <!-- Exception Hub start -->
    <script src="http://js.exceptionhub.com/javascripts/eh.js"></script>
    <script>
    ExceptionHub.setup("8ff0f84d25456b049a9c1a83f8e62b56", 21, 'production');
    </script>
    <!-- Exception Hub end -->

    <script type="text/javascript" src="/js/jquery-1.3.2.min.js"></script>
    <!--<script type="text/javascript" src="/js/chili/jquery.chili-2.2.js"></script>-->
    <script type="text/javascript" src="/js/consul.js"></script>
    <script type="text/javascript">
      // ChiliBook.recipeFolder = "/js/chili/";
      consul.turnOn();
      jQuery.noConflict();

      var AG = {};
      // Page Script
    </script>

    <!-- Include LABjs and request the rest of the script files-->
    <script type="text/javascript" src="/js/LAB.min.js"></script>
    <script type="text/javascript">
      $LAB
      .script("/js/jquery-ui-1.7.2.custom.min.js")
      .script("/js/jquery.templates.js")
      .script("/js/base.js")
      .script("/js/ag.js")
    </script>

    <!-- Google Analytics -->
    <script type="text/javascript">var _gaq =_gaq||[]; _gaq.push(['_setAccount','UA-251077-4']);_gaq.push(['_trackPageview']);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(ga);})();</script>
  </body>
</html>
